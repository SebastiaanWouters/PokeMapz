{"version":3,"sources":["../../js/map.js"],"names":["$selectExclude","$selectPokemonNotify","$selectRarityNotify","$textPerfectionNotify","$selectStyle","$selectIconSize","$selectOpenGymsOnly","$selectTeamGymsOnly","$selectLastUpdateGymsOnly","$selectMinGymLevel","$selectMaxGymLevel","$selectLuredPokestopsOnly","$selectSearchIconMarker","$selectGymMarkerStyle","$selectLocationIconMarker","$switchGymSidebar","$timeoutDialog","language","document","documentElement","lang","idToPokemon","i8lnDictionary","languageLookups","languageLookupThreshold","searchMarkerStyles","timestamp","excludedPokemon","notifiedPokemon","notifiedRarity","notifiedMinPerfection","buffer","reincludedPokemon","reids","map","rawDataIsLoading","locationMarker","rangeMarkers","searchMarker","storeZoom","scanPath","moves","oSwLat","oSwLng","oNeLat","oNeLng","lastpokestops","lastgyms","lastpokemon","lastslocs","lastspawns","selectedStyle","updateWorker","lastUpdateTime","gymTypes","gymPrestige","audio","Audio","notifyIvTitle","notifyNoIvTitle","notifyText","excludePokemon","id","val","concat","trigger","notifyAboutPokemon","removePokemonMarker","encounterId","mapData","pokemons","marker","rangeCircle","setMap","hidden","initMap","google","maps","Map","getElementById","center","lat","centerLat","lng","centerLng","zoom","Store","get","fullscreenControl","streetViewControl","mapTypeControl","clickableIcons","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","position","ControlPosition","RIGHT_TOP","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","HYBRID","styleNoLabels","StyledMapType","noLabelsStyle","name","mapTypes","set","styleDark","darkStyle","styleLight2","light2Style","stylePgo","pGoStyle","styleDarkNl","darkStyleNoLabels","styleLight2Nl","light2StyleNoLabels","stylePgoNl","pGoStyleNoLabels","stylePgoDay","pGoStyleDay","stylePgoNight","pGoStyleNight","currentDate","Date","currentHour","getHours","stylePgoDynamic","addListener","s","mapTypeId","setMapTypeId","updateMap","getZoom","redrawPokemon","lurePokemons","createSearchMarker","createLocationMarker","createMyLocationButton","initSidebar","$","on","loc","getCenter","changeLocation","checked","prop","searchControl","updateLocationMarker","setIcon","icon","Marker","animation","Animation","DROP","draggable","optimized","zIndex","MAX_ZINDEX","infoWindow","InfoWindow","content","disableAutoPan","addListeners","event","newLocation","getPosition","updateSearchMarker","oldLocation","changeSearchLocation","done","fail","setPosition","searchControlURI","action","post","encodeURIComponent","toggleClass","updateSearchStatus","getJSON","then","data","status","toggle","searchBox","places","Autocomplete","css","setInterval","place","getPlace","geometry","location","pad","number","slice","getTypeSpan","type","openMapDirections","url","window","open","pokemonLabel","rarity","types","disappearTime","latitude","longitude","atk","def","sta","move1","move2","disappearDate","rarityDisplay","typesDisplay","each","index","details","iv","toFixed","i8ln","contentstring","getMinutes","getSeconds","gymLabel","teamName","teamId","gymPoints","lastScanned","members","gymId","memberStr","i","length","pokemon_name","trainer_name","trainer_level","pokemon_id","pokemon_cp","lastScannedStr","lastScannedDate","getFullYear","getMonth","getDate","directionsStr","nameStr","gymColor","str","gymLevel","getGymLevel","points","level","pokestopLabel","expireTime","expireDate","formatSpawnTime","seconds","Math","floor","substr","spawnpointLabel","item","time","special","addRangeCircle","targetmap","circleCenter","LatLng","gymColors","teamColor","range","circleColor","rangeCircleOpts","radius","strokeWeight","strokeColor","strokeOpacity","fillColor","fillOpacity","Circle","isRangeActive","getIv","stm","lpad","len","padstr","Array","max","String","join","repArray","text","find","replace","getTimeUntil","now","tdiff","sec","min","hour","getNotifyText","ntitle","dist","toLocaleString","minute","second","hour12","until","udist","ntext","customizePokemonMarker","skipNotification","setAnimation","animationDisabled","indexOf","play","sendNotification","fav_title","fav_text","BOUNCE","perfection","setupGymMarker","scaledSize","Size","gymSidebar","querySelector","getAttribute","classList","contains","remove","setAttribute","showGymDetails","persist","isMobileDevice","isTouchDevice","clearSelection","updateLabelDiffTime","close","updateGymMarker","setContent","updateGymIcons","gyms","key","value","setupPokestopMarker","imagename","getColorByDate","diff","hue","toString","setupScannedMarker","clickable","getColorBySpawnTime","round","changeSpawnIcon","color","urlColor","zoomScale","minimumSize","newSize","newIcon","anchor","Point","spawnPointIndex","newIndex","scale","setupSpawnpointMarker","selection","empty","getSelection","removeAllRanges","infoWindowIsOpen","clearStaleMarkers","getTime","scanned","showInBoundsMarkers","markers","show","getBounds","intersects","team_id","getMap","oldAnimation","getAnimation","loadRawData","loadPokemon","loadGyms","loadPokestops","loadScanned","loadSpawnpoints","loadLuredOnly","Boolean","bounds","swPoint","getSouthWest","nePoint","getNorthEast","swLat","swLng","neLat","neLng","ajax","dataType","cache","beforeSend","error","opts","title","dialog","complete","processPokemons","setupPokemonMarker","processPokestops","pokestops","item2","updatePokestops","removeStops","currentTime","push","processGyms","gym_points","removeGymFromMap","gymid","gymHasOpenSpot","pokemonInGym","pokemon","closePrestige","last_scanned","processScanned","scanId","last_modified","updateScanned","setOptions","processSpawnpoints","spawnpoints","updateSpawnPoints","setZIndex","result","hasClass","countMarkers","filter","e","drawScanPath","scanPathPoints","idx","point","Polyline","path","geodesic","pokemonList","newMarker","element","disappearsAt","parseInt","hours","minutes","timestring","ttime","getPointDistance","pointA","pointB","spherical","computeDistanceBetween","Notification","permission","requestPermission","notification","body","sound","onclick","focus","centerMap","locationContainer","createElement","locationButton","backgroundColor","border","outline","width","height","borderRadius","boxShadow","cursor","marginRight","padding","appendChild","locationIcon","margin","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","addEventListener","centerMapOnLocation","controls","RIGHT_BOTTOM","currentLocation","imgX","animationInterval","navigator","geolocation","getCurrentPosition","latlng","coords","setCenter","clearInterval","setZoom","word","isEmptyObject","async","success","jqXHR","console","log","updateGeoLocation","panTo","createUpdateWorker","Worker","updateBlob","Blob","updateBlobURL","URL","createObjectURL","onmessage","postMessage","ex","message","sidebar","sidebarClose","add","nextLvlPrestige","prestigePercentage","freeSlots","freeSlotsStr","gymLevelStr","pokemonHtml","headerHtml","perfectPercent","iv_attack","iv_defense","iv_stamina","moveEnergy","move_2_energy","move_1_name","move_1_type","toLowerCase","move_1_damage","move_2_name","move_2_type","move_2_damage","guard_pokemon_id","guard_pokemon_name","innerHTML","href","className","tabIndex","preventDefault","stopPropagation","toggleGymPokemonDetails","lastElementChild","firstElementChild","nextElementSibling","styleList","select2","placeholder","minimumResultsForSearch","Infinity","d","dType","searchMarkerStyleList","selectSearchIconMarker","formatState","state","$state","numberOfPokemon","pokeList","_types","pokemonType","templateResult","Number","isNaN","buildSwitchChangeListener","storageKey","change","options","wrapper","hide","wrapper2","bind","setDraggable","alert","accordion","active","collapsible","heightStyle","DataTable","paging","searching","info","errMode","order"],"mappings":"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","file":"map.built.js","sourcesContent":["//\n// Global map.js variables\n//\n\nvar $selectExclude\nvar $selectPokemonNotify\nvar $selectRarityNotify\nvar $textPerfectionNotify\nvar $selectStyle\nvar $selectIconSize\nvar $selectOpenGymsOnly\nvar $selectTeamGymsOnly\nvar $selectLastUpdateGymsOnly\nvar $selectMinGymLevel\nvar $selectMaxGymLevel\nvar $selectLuredPokestopsOnly\nvar $selectSearchIconMarker\nvar $selectGymMarkerStyle\nvar $selectLocationIconMarker\nvar $switchGymSidebar\nvar $timeoutDialog\n\nvar language = document.documentElement.lang === '' ? 'en' : document.documentElement.lang\nvar idToPokemon = {}\nvar i8lnDictionary = {}\nvar languageLookups = 0\nvar languageLookupThreshold = 3\n\nvar searchMarkerStyles\n\nvar timestamp\nvar excludedPokemon = []\nvar notifiedPokemon = []\nvar notifiedRarity = []\nvar notifiedMinPerfection = null\n\nvar buffer = []\nvar reincludedPokemon = []\nvar reids = []\n\nvar map\nvar rawDataIsLoading = false\nvar locationMarker\nvar rangeMarkers = ['pokemon', 'pokestop', 'gym']\nvar searchMarker\nvar storeZoom = true\nvar scanPath\nvar moves\n\nvar oSwLat\nvar oSwLng\nvar oNeLat\nvar oNeLng\n\nvar lastpokestops\nvar lastgyms\nvar lastpokemon\nvar lastslocs\nvar lastspawns\n\nvar selectedStyle = 'light'\n\nvar updateWorker\nvar lastUpdateTime\n\nvar gymTypes = ['Uncontested', 'Mystic', 'Valor', 'Instinct']\nvar gymPrestige = [2000, 4000, 8000, 12000, 16000, 20000, 30000, 40000, 50000]\nvar audio = new Audio('static/sounds/ding.mp3')\n\n/*\n  text place holders:\n  <pkm> - pokemon name\n  <prc> - iv in percent without percent symbol\n  <atk> - attack as number\n  <def> - defense as number\n  <sta> - stamnia as number\n*/\nvar notifyIvTitle = '<pkm> <prc>% (<atk>/<def>/<sta>)'\nvar notifyNoIvTitle = '<pkm>'\n\n/*\n  text place holders:\n  <dist>  - disappear time\n  <udist> - time until disappear\n*/\nvar notifyText = 'disappears at <dist> (<udist>)'\n\n//\n// Functions\n//\n\nfunction excludePokemon(id) { // eslint-disable-line no-unused-vars\n    $selectExclude.val(\n        $selectExclude.val().concat(id)\n    ).trigger('change')\n}\n\nfunction notifyAboutPokemon(id) { // eslint-disable-line no-unused-vars\n    $selectPokemonNotify.val(\n        $selectPokemonNotify.val().concat(id)\n    ).trigger('change')\n}\n\nfunction removePokemonMarker(encounterId) { // eslint-disable-line no-unused-vars\n    if (mapData.pokemons[encounterId].marker.rangeCircle) {\n        mapData.pokemons[encounterId].marker.rangeCircle.setMap(null)\n        delete mapData.pokemons[encounterId].marker.rangeCircle\n    }\n    mapData.pokemons[encounterId].marker.setMap(null)\n    mapData.pokemons[encounterId].hidden = true\n}\n\nfunction initMap() { // eslint-disable-line no-unused-vars\n    map = new google.maps.Map(document.getElementById('map'), {\n        center: {\n            lat: centerLat,\n            lng: centerLng\n        },\n        zoom: Store.get('zoomLevel'),\n        fullscreenControl: true,\n        streetViewControl: false,\n        mapTypeControl: false,\n        clickableIcons: false,\n        mapTypeControlOptions: {\n            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\n            position: google.maps.ControlPosition.RIGHT_TOP,\n            mapTypeIds: [\n                google.maps.MapTypeId.ROADMAP,\n                google.maps.MapTypeId.SATELLITE,\n                google.maps.MapTypeId.HYBRID,\n                'nolabels_style',\n                'dark_style',\n                'style_light2',\n                'style_pgo',\n                'dark_style_nl',\n                'style_light2_nl',\n                'style_pgo_nl',\n                'style_pgo_day',\n                'style_pgo_night',\n                'style_pgo_dynamic'\n            ]\n        }\n    })\n\n    var styleNoLabels = new google.maps.StyledMapType(noLabelsStyle, {\n        name: 'No Labels'\n    })\n    map.mapTypes.set('nolabels_style', styleNoLabels)\n\n    var styleDark = new google.maps.StyledMapType(darkStyle, {\n        name: 'Dark'\n    })\n    map.mapTypes.set('dark_style', styleDark)\n\n    var styleLight2 = new google.maps.StyledMapType(light2Style, {\n        name: 'Light2'\n    })\n    map.mapTypes.set('style_light2', styleLight2)\n\n    var stylePgo = new google.maps.StyledMapType(pGoStyle, {\n        name: 'PokemonGo'\n    })\n    map.mapTypes.set('style_pgo', stylePgo)\n\n    var styleDarkNl = new google.maps.StyledMapType(darkStyleNoLabels, {\n        name: 'Dark (No Labels)'\n    })\n    map.mapTypes.set('dark_style_nl', styleDarkNl)\n\n    var styleLight2Nl = new google.maps.StyledMapType(light2StyleNoLabels, {\n        name: 'Light2 (No Labels)'\n    })\n    map.mapTypes.set('style_light2_nl', styleLight2Nl)\n\n    var stylePgoNl = new google.maps.StyledMapType(pGoStyleNoLabels, {\n        name: 'PokemonGo (No Labels)'\n    })\n    map.mapTypes.set('style_pgo_nl', stylePgoNl)\n\n    var stylePgoDay = new google.maps.StyledMapType(pGoStyleDay, {\n        name: 'PokemonGo Day'\n    })\n    map.mapTypes.set('style_pgo_day', stylePgoDay)\n\n    var stylePgoNight = new google.maps.StyledMapType(pGoStyleNight, {\n        name: 'PokemonGo Night'\n    })\n    map.mapTypes.set('style_pgo_night', stylePgoNight)\n\n    // dynamic map style chooses stylePgoDay or stylePgoNight depending on client time\n    var currentDate = new Date()\n    var currentHour = currentDate.getHours()\n    var stylePgoDynamic = (currentHour >= 6 && currentHour < 19) ? stylePgoDay : stylePgoNight\n    map.mapTypes.set('style_pgo_dynamic', stylePgoDynamic)\n\n    map.addListener('maptypeid_changed', function (s) {\n        Store.set('map_style', this.mapTypeId)\n    })\n\n    map.setMapTypeId(Store.get('map_style'))\n    map.addListener('idle', updateMap)\n\n    map.addListener('zoom_changed', function () {\n        if (storeZoom === true) {\n            Store.set('zoomLevel', this.getZoom())\n        } else {\n            storeZoom = true\n        }\n\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n    })\n\n    searchMarker = createSearchMarker()\n    locationMarker = createLocationMarker()\n    createMyLocationButton()\n    initSidebar()\n\n    $('#scan-here').on('click', function () {\n        var loc = map.getCenter()\n        changeLocation(loc.lat(), loc.lng())\n\n        if (!$('#search-switch').checked) {\n            $('#search-switch').prop('checked', true)\n            searchControl('on')\n        }\n    })\n}\n\nfunction updateLocationMarker(style) {\n    if (style in searchMarkerStyles) {\n        locationMarker.setIcon(searchMarkerStyles[style].icon)\n        Store.set('locationMarkerStyle', style)\n    }\n    return locationMarker\n}\n\nfunction createLocationMarker() {\n    var position = Store.get('followMyLocationPosition')\n    var lat = ('lat' in position) ? position.lat : centerLat\n    var lng = ('lng' in position) ? position.lng : centerLng\n\n    var locationMarker = new google.maps.Marker({\n        map: map,\n        animation: google.maps.Animation.DROP,\n        position: {\n            lat: lat,\n            lng: lng\n        },\n        draggable: true,\n        icon: null,\n        optimized: false,\n        zIndex: google.maps.Marker.MAX_ZINDEX + 2\n    })\n\n    locationMarker.infoWindow = new google.maps.InfoWindow({\n        content: '<div><b>My Location</b></div>',\n        disableAutoPan: true\n    })\n\n    addListeners(locationMarker)\n\n    google.maps.event.addListener(locationMarker, 'dragend', function () {\n        var newLocation = locationMarker.getPosition()\n        Store.set('followMyLocationPosition', {\n            lat: newLocation.lat(),\n            lng: newLocation.lng()\n        })\n    })\n\n    return locationMarker\n}\n\nfunction updateSearchMarker(style) {\n    if (style in searchMarkerStyles) {\n        searchMarker.setIcon(searchMarkerStyles[style].icon)\n        Store.set('searchMarkerStyle', style)\n    }\n\n    return searchMarker\n}\n\nfunction createSearchMarker() {\n    var searchMarker = new google.maps.Marker({ // need to keep reference.\n        position: {\n            lat: centerLat,\n            lng: centerLng\n        },\n        map: map,\n        animation: google.maps.Animation.DROP,\n        draggable: !Store.get('lockMarker'),\n        icon: null,\n        optimized: false,\n        zIndex: google.maps.Marker.MAX_ZINDEX + 1\n    })\n\n    searchMarker.infoWindow = new google.maps.InfoWindow({\n        content: '<div><b>Search Location</b></div>',\n        disableAutoPan: true\n    })\n\n    addListeners(searchMarker)\n\n    var oldLocation = null\n    google.maps.event.addListener(searchMarker, 'dragstart', function () {\n        oldLocation = searchMarker.getPosition()\n    })\n\n    google.maps.event.addListener(searchMarker, 'dragend', function () {\n        var newLocation = searchMarker.getPosition()\n        changeSearchLocation(newLocation.lat(), newLocation.lng())\n            .done(function () {\n                oldLocation = null\n            })\n            .fail(function () {\n                if (oldLocation) {\n                    searchMarker.setPosition(oldLocation)\n                }\n            })\n    })\n\n    return searchMarker\n}\n\nvar searchControlURI = 'search_control'\n\nfunction searchControl(action) {\n    $.post(searchControlURI + '?action=' + encodeURIComponent(action))\n    $('#scan-here').toggleClass('disabled', action === 'off')\n}\n\nfunction updateSearchStatus() {\n    $.getJSON(searchControlURI).then(function (data) {\n        $('#search-switch').prop('checked', data.status)\n        $('#scan-here').toggleClass('disabled', !data.status)\n    })\n}\n\nfunction initSidebar() {\n    $('#gyms-switch').prop('checked', Store.get('showGyms'))\n    $('#gym-sidebar-switch').prop('checked', Store.get('useGymSidebar'))\n    $('#gym-sidebar-wrapper').toggle(Store.get('showGyms'))\n    $('#gyms-filter-wrapper').toggle(Store.get('showGyms'))\n    $('#team-gyms-only-switch').val(Store.get('showTeamGymsOnly'))\n    $('#open-gyms-only-switch').val(Store.get('showOpenGymsOnly'))\n    $('#min-level-gyms-filter-switch').val(Store.get('minGymLevel'))\n    $('#max-level-gyms-filter-switch').val(Store.get('maxGymLevel'))\n    $('#last-update-gyms-switch').val(Store.get('showLastUpdatedGymsOnly'))\n    $('#pokemon-switch').prop('checked', Store.get('showPokemon'))\n    $('#pokestops-switch').prop('checked', Store.get('showPokestops'))\n    $('#lured-pokestops-only-switch').val(Store.get('showLuredPokestopsOnly'))\n    $('#lured-pokestops-only-wrapper').toggle(Store.get('showPokestops'))\n    $('#geoloc-switch').prop('checked', Store.get('geoLocate'))\n    $('#lock-marker-switch').prop('checked', Store.get('lockMarker'))\n    $('#start-at-user-location-switch').prop('checked', Store.get('startAtUserLocation'))\n    $('#follow-my-location-switch').prop('checked', Store.get('followMyLocation'))\n    $('#scan-here-switch').prop('checked', Store.get('scanHere'))\n    $('#scan-here').toggle(Store.get('scanHere'))\n    $('#scanned-switch').prop('checked', Store.get('showScanned'))\n    $('#spawnpoints-switch').prop('checked', Store.get('showSpawnpoints'))\n    $('#ranges-switch').prop('checked', Store.get('showRanges'))\n    $('#sound-switch').prop('checked', Store.get('playSound'))\n    var searchBox = new google.maps.places.Autocomplete(document.getElementById('next-location'))\n    $('#next-location').css('background-color', $('#geoloc-switch').prop('checked') ? '#e0e0e0' : '#ffffff')\n\n    updateSearchStatus()\n    setInterval(updateSearchStatus, 5000)\n\n    searchBox.addListener('place_changed', function () {\n        var place = searchBox.getPlace()\n\n        if (!place.geometry) return\n\n        var loc = place.geometry.location\n        changeLocation(loc.lat(), loc.lng())\n    })\n\n    $('#pokemon-icon-size').val(Store.get('iconSizeModifier'))\n}\n\nfunction pad(number) {\n    return number <= 99 ? ('0' + number).slice(-2) : number\n}\n\nfunction getTypeSpan(type) {\n    return `<span style='padding: 2px 5px; text-transform: uppercase; color: white; margin-right: 2px; border-radius: 4px; font-size: 0.8em; vertical-align: text-bottom; background-color: ${type['color']}'>${type['type']}</span>`\n}\n\nfunction openMapDirections(lat, lng) { // eslint-disable-line no-unused-vars\n    var url = 'https://www.google.com/maps/?daddr=' + lat + ',' + lng\n    window.open(url, '_blank')\n}\n\nfunction pokemonLabel(name, rarity, types, disappearTime, id, latitude, longitude, encounterId, atk, def, sta, move1, move2) {\n    var disappearDate = new Date(disappearTime)\n    var rarityDisplay = rarity ? '(' + rarity + ')' : ''\n    var typesDisplay = ''\n    $.each(types, function (index, type) {\n        typesDisplay += getTypeSpan(type)\n    })\n    var details = ''\n    if (atk != null) {\n        var iv = (atk + def + sta) / 45 * 100\n        details = `\n            <div>\n                IV: ${iv.toFixed(1)}% (${atk}/${def}/${sta})\n            </div>\n            <div>\n                Moves: ${i8ln(moves[move1]['name'])} / ${i8ln(moves[move2]['name'])}\n            </div>\n            `\n    }\n    var contentstring = `\n        <div>\n            <b>${name}</b>\n            <span> - </span>\n            <small>\n                <a href='http://www.pokemon.com/us/pokedex/${id}' target='_blank' title='View in Pokedex'>#${id}</a>\n            </small>\n            <span> ${rarityDisplay}</span>\n            <span> - </span>\n            <small>${typesDisplay}</small>\n        </div>\n        <div>\n            Disappears at ${pad(disappearDate.getHours())}:${pad(disappearDate.getMinutes())}:${pad(disappearDate.getSeconds())}\n            <span class='label-countdown' disappears-at='${disappearTime}'>(00m00s)</span>\n        </div>\n        <div>\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n        </div>\n            ${details}\n        <div>\n            <a href='javascript:excludePokemon(${id})'>Exclude</a>&nbsp;&nbsp\n            <a href='javascript:notifyAboutPokemon(${id})'>Notify</a>&nbsp;&nbsp\n            <a href='javascript:removePokemonMarker(\"${encounterId}\")'>Remove</a>&nbsp;&nbsp\n            <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n        </div>`\n    return contentstring\n}\n\nfunction gymLabel(teamName, teamId, gymPoints, latitude, longitude, lastScanned = null, name = null, members = [], gymId) {\n    var memberStr = ''\n    for (var i = 0; i < members.length; i++) {\n        memberStr += `\n            <span class=\"gym-member\" title=\"${members[i].pokemon_name} | ${members[i].trainer_name} (Lvl ${members[i].trainer_level})\">\n                <i class=\"pokemon-sprite n${members[i].pokemon_id}\"></i>\n                <span class=\"cp team-${teamId}\">${members[i].pokemon_cp}</span>\n            </span>`\n    }\n\n    var lastScannedStr\n    if (lastScanned) {\n        var lastScannedDate = new Date(lastScanned)\n        lastScannedStr = `${lastScannedDate.getFullYear()}-${pad(lastScannedDate.getMonth() + 1)}-${pad(lastScannedDate.getDate())} ${pad(lastScannedDate.getHours())}:${pad(lastScannedDate.getMinutes())}:${pad(lastScannedDate.getSeconds())}`\n    } else {\n        lastScannedStr = 'Unknown'\n    }\n    var directionsStr = ''\n    if (!Store.get('useGymSidebar')) {\n        directionsStr = `<div>\n                <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n            </div>`\n    }\n\n    var nameStr = (name ? `<div>${name}</div>` : '')\n\n    var gymColor = ['0, 0, 0, .4', '74, 138, 202, .6', '240, 68, 58, .6', '254, 217, 40, .6']\n    var str\n    if (teamId === 0) {\n        str = `\n            <div>\n                <center>\n                    <div>\n                        <b style='color:rgba(${gymColor[teamId]})'>${teamName}</b><br>\n                        <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\n                    </div>\n                    ${nameStr}\n                    <div>\n                        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n                    </div>\n                    <div>\n                        Last Scanned: ${lastScannedStr}\n                    </div>\n                    ${directionsStr}\n                </center>\n            </div>`\n    } else {\n        var gymLevel = getGymLevel(gymPoints)\n        str = `\n            <div>\n                <center>\n                    <div style='padding-bottom: 2px'>\n                        Gym owned by:\n                    </div>\n                    <div>\n                        <b style='color:rgba(${gymColor[teamId]})'>Team ${teamName}</b><br>\n                        <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\n                    </div>\n                    <div>\n                        ${nameStr}\n                    </div>\n                    <div>\n                        Level: ${gymLevel} | Prestige: ${gymPoints}/${gymPrestige[gymLevel - 1] || 50000}\n                    </div>\n                    <div>\n                        ${memberStr}\n                    </div>\n                    <div>\n                        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n                    </div>\n                    <div>\n                        Last Scanned: ${lastScannedStr}\n                    </div>\n                    ${directionsStr}\n                </center>\n            </div>`\n    }\n\n    return str\n}\n\nfunction getGymLevel(points) {\n    var level = 1\n    while (points >= gymPrestige[level - 1]) {\n        level++\n    }\n\n    return level\n}\n\nfunction pokestopLabel(expireTime, latitude, longitude) {\n    var str\n    if (expireTime) {\n        var expireDate = new Date(expireTime)\n\n        str = `\n            <div>\n                <b>Lured Pokéstop</b>\n            </div>\n            <div>\n                Lure expires at ${pad(expireDate.getHours())}:${pad(expireDate.getMinutes())}:${pad(expireDate.getSeconds())}\n                <span class='label-countdown' disappears-at='${expireTime}'>(00m00s)</span>\n            </div>\n            <div>\n                Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n            </div>\n            <div>\n                <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n            </div>`\n    } else {\n        str = `\n            <div>\n                <b>Pokéstop</b>\n            </div>\n            <div>\n                Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n            </div>\n            <div>\n                <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n            </div>`\n    }\n\n    return str\n}\n\nfunction formatSpawnTime(seconds) {\n    // the addition and modulo are required here because the db stores when a spawn disappears\n    // the subtraction to get the appearance time will knock seconds under 0 if the spawn happens in the previous hour\n    return ('0' + Math.floor(((seconds + 3600) % 3600) / 60)).substr(-2) + ':' + ('0' + seconds % 60).substr(-2)\n}\n\nfunction spawnpointLabel(item) {\n    var str = `\n        <div>\n            <b>Spawn Point</b>\n        </div>\n        <div>\n            Every hour from ${formatSpawnTime(item.time)} to ${formatSpawnTime(item.time + 900)}\n        </div>`\n\n    if (item.special) {\n        str += `\n            <div>\n                May appear as early as ${formatSpawnTime(item.time - 1800)}\n            </div>`\n    }\n    return str\n}\n\nfunction addRangeCircle(marker, map, type, teamId) {\n    var targetmap = null\n    var circleCenter = new google.maps.LatLng(marker.position.lat(), marker.position.lng())\n    var gymColors = ['#999999', '#0051CF', '#FF260E', '#FECC23'] // 'Uncontested', 'Mystic', 'Valor', 'Instinct']\n    var teamColor = gymColors[0]\n    if (teamId) teamColor = gymColors[teamId]\n\n    var range\n    var circleColor\n\n    // handle each type of marker and be explicit about the range circle attributes\n    switch (type) {\n        case 'pokemon':\n            circleColor = '#C233F2'\n            range = 40 // pokemon appear at 40m and then you can move away. still have to be 40m close to see it though, so ignore the further disappear distance\n            break\n        case 'pokestop':\n            circleColor = '#3EB0FF'\n            range = 40\n            break\n        case 'gym':\n            circleColor = teamColor\n            range = 40\n            break\n    }\n\n    if (map) targetmap = map\n\n    var rangeCircleOpts = {\n        map: targetmap,\n        radius: range, // meters\n        strokeWeight: 1,\n        strokeColor: circleColor,\n        strokeOpacity: 0.9,\n        center: circleCenter,\n        fillColor: circleColor,\n        fillOpacity: 0.3\n    }\n    var rangeCircle = new google.maps.Circle(rangeCircleOpts)\n    return rangeCircle\n}\n\nfunction isRangeActive(map) {\n    if (map.getZoom() < 16) return false\n    return Store.get('showRanges')\n}\n\nfunction getIv(atk, def, stm) {\n    if (atk !== null) {\n        return 100.0 * (atk + def + stm) / 45\n    }\n\n    return false\n}\n\nfunction lpad(str, len, padstr) {\n    return Array(Math.max(len - String(str).length + 1, 0)).join(padstr) + str\n}\n\nfunction repArray(text, find, replace) {\n    for (var i = 0; i < find.length; i++) {\n        text = text.replace(find[i], replace[i])\n    }\n\n    return text\n}\n\nfunction getTimeUntil(time) {\n    var now = +new Date()\n    var tdiff = time - now\n\n    var sec = Math.floor((tdiff / 1000) % 60)\n    var min = Math.floor((tdiff / 1000 / 60) % 60)\n    var hour = Math.floor((tdiff / (1000 * 60 * 60)) % 24)\n\n    return {\n        'total': tdiff,\n        'hour': hour,\n        'min': min,\n        'sec': sec,\n        'now': now,\n        'ttime': time\n    }\n}\n\nfunction getNotifyText(item) {\n    var iv = getIv(item['individual_attack'], item['individual_defense'], item['individual_stamina'])\n    var find = ['<prc>', '<pkm>', '<atk>', '<def>', '<sta>']\n    var replace = [((iv) ? iv.toFixed(1) : ''), item['pokemon_name'], item['individual_attack'],\n        item['individual_defense'], item['individual_stamina']]\n    var ntitle = repArray(((iv) ? notifyIvTitle : notifyNoIvTitle), find, replace)\n    var dist = (new Date(item['disappear_time'])).toLocaleString([], {\n        hour: '2-digit', minute: '2-digit',\n        second: '2-digit', hour12: false})\n    var until = getTimeUntil(item['disappear_time'])\n    var udist = (until.hour > 0) ? until.hour + ':' : ''\n    udist += lpad(until.min, 2, 0) + 'm' + lpad(until.sec, 2, 0) + 's'\n    find = ['<dist>', '<udist>']\n    replace = [dist, udist]\n    var ntext = repArray(notifyText, find, replace)\n\n    return {\n        'fav_title': ntitle,\n        'fav_text': ntext\n    }\n}\n\nfunction customizePokemonMarker(marker, item, skipNotification) {\n    marker.addListener('click', function () {\n        this.setAnimation(null)\n        this.animationDisabled = true\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokemon')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokemonLabel(item['pokemon_name'], item['pokemon_rarity'], item['pokemon_types'], item['disappear_time'], item['pokemon_id'], item['latitude'], item['longitude'], item['encounter_id'], item['individual_attack'], item['individual_defense'], item['individual_stamina'], item['move_1'], item['move_2']),\n        disableAutoPan: true\n    })\n\n    if (notifiedPokemon.indexOf(item['pokemon_id']) > -1 || notifiedRarity.indexOf(item['pokemon_rarity']) > -1) {\n        if (!skipNotification) {\n            if (Store.get('playSound')) {\n                audio.play()\n            }\n            sendNotification(getNotifyText(item).fav_title, getNotifyText(item).fav_text, 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n        }\n        if (marker.animationDisabled !== true) {\n            marker.setAnimation(google.maps.Animation.BOUNCE)\n        }\n    }\n\n    if (item['individual_attack'] != null) {\n        var perfection = getIv(item['individual_attack'], item['individual_defense'], item['individual_stamina'])\n        if (notifiedMinPerfection > 0 && perfection >= notifiedMinPerfection) {\n            if (!skipNotification) {\n                if (Store.get('playSound')) {\n                    audio.play()\n                }\n                sendNotification(getNotifyText(item).fav_title, getNotifyText(item).fav_text, 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n            }\n            if (marker.animationDisabled !== true) {\n                marker.setAnimation(google.maps.Animation.BOUNCE)\n            }\n        }\n    }\n\n    addListeners(marker)\n}\n\nfunction setupGymMarker(item) {\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map,\n        icon: {\n            url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        }\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'gym', item['team_id'])\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon'], item['gym_id']),\n        disableAutoPan: true\n    })\n\n    if (Store.get('useGymSidebar')) {\n        marker.addListener('click', function () {\n            var gymSidebar = document.querySelector('#gym-details')\n            if (gymSidebar.getAttribute('data-id') === item['gym_id'] && gymSidebar.classList.contains('visible')) {\n                gymSidebar.classList.remove('visible')\n            } else {\n                gymSidebar.setAttribute('data-id', item['gym_id'])\n                showGymDetails(item['gym_id'])\n            }\n        })\n\n        google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n            marker.persist = null\n        })\n\n        if (!isMobileDevice() && !isTouchDevice()) {\n            marker.addListener('mouseover', function () {\n                marker.infoWindow.open(map, marker)\n                clearSelection()\n                updateLabelDiffTime()\n            })\n        }\n\n        marker.addListener('mouseout', function () {\n            if (!marker.persist) {\n                marker.infoWindow.close()\n            }\n        })\n    } else {\n        addListeners(marker)\n    }\n    return marker\n}\n\nfunction updateGymMarker(item, marker) {\n    marker.setIcon({\n        url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png',\n        scaledSize: new google.maps.Size(48, 48)\n    })\n    marker.infoWindow.setContent(gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon'], item['gym_id']))\n    return marker\n}\n\nfunction updateGymIcons() {\n    $.each(mapData.gyms, function (key, value) {\n        mapData.gyms[key]['marker'].setIcon({\n            url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[mapData.gyms[key]['team_id']] + (mapData.gyms[key]['team_id'] !== 0 ? '_' + getGymLevel(mapData.gyms[key]['gym_points']) : '') + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        })\n    })\n}\n\nfunction setupPokestopMarker(item) {\n    var imagename = item['lure_expiration'] ? 'PstopLured' : 'Pstop'\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map,\n        zIndex: 2,\n        icon: 'static/forts/' + imagename + '.png'\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokestop')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokestopLabel(item['lure_expiration'], item['latitude'], item['longitude']),\n        disableAutoPan: true\n    })\n\n    addListeners(marker)\n    return marker\n}\n\nfunction getColorByDate(value) {\n    // Changes the color from red to green over 15 mins\n    var diff = (Date.now() - value) / 1000 / 60 / 15\n\n    if (diff > 1) {\n        diff = 1\n    }\n\n    // value from 0 to 1 - Green to Red\n    var hue = ((1 - diff) * 120).toString(10)\n    return ['hsl(', hue, ',100%,50%)'].join('')\n}\n\nfunction setupScannedMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n\n    var marker = new google.maps.Circle({\n        map: map,\n        clickable: false,\n        center: circleCenter,\n        radius: 70, // metres\n        fillColor: getColorByDate(item['last_modified']),\n        fillOpacity: 0.1,\n        strokeWeight: 1,\n        strokeOpacity: 0.5\n    })\n\n    return marker\n}\n\nfunction getColorBySpawnTime(value) {\n    var now = new Date()\n    var seconds = now.getMinutes() * 60 + now.getSeconds()\n\n    // account for hour roll-over\n    if (seconds < 900 && value > 2700) {\n        seconds += 3600\n    } else if (seconds > 2700 && value < 900) {\n        value += 3600\n    }\n\n    var diff = (seconds - value)\n    var hue = 275 // light purple when spawn is neither about to spawn nor active\n    if (diff >= 0 && diff <= 900) { // green to red over 15 minutes of active spawn\n        hue = (1 - (diff / 60 / 15)) * 120\n    } else if (diff < 0 && diff > -300) { // light blue to dark blue over 5 minutes til spawn\n        hue = ((1 - (-diff / 60 / 5)) * 50) + 200\n    }\n\n    hue = Math.round(hue / 5) * 5\n\n    return hue\n}\n\nfunction changeSpawnIcon(color, zoom) {\n    var urlColor = ''\n    if (color === 275) {\n        urlColor = './static/icons/hsl-275-light.png'\n    } else {\n        urlColor = './static/icons/hsl-' + color + '.png'\n    }\n    var zoomScale = 1.6 // adjust this value to change the size of the spawnpoint icons\n    var minimumSize = 1\n    var newSize = Math.round(zoomScale * (zoom - 10)) // this scales the icon based on zoom\n    if (newSize < minimumSize) {\n        newSize = minimumSize\n    }\n\n    var newIcon = {\n        url: urlColor,\n        scaledSize: new google.maps.Size(newSize, newSize),\n        anchor: new google.maps.Point(newSize / 2, newSize / 2)\n    }\n\n    return newIcon\n}\n\nfunction spawnPointIndex(color) {\n    var newIndex = 1\n    var scale = 0\n    if (color >= 0 && color <= 120) { // high to low over 15 minutes of active spawn\n        scale = color / 120\n        newIndex = 100 + scale * 100\n    } else if (color >= 200 && color <= 250) { // low to high over 5 minutes til spawn\n        scale = (color - 200) / 50\n        newIndex = scale * 100\n    }\n\n    return newIndex\n}\n\nfunction setupSpawnpointMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n    var hue = getColorBySpawnTime(item.time)\n    var zoom = map.getZoom()\n\n    var marker = new google.maps.Marker({\n        map: map,\n        position: circleCenter,\n        icon: changeSpawnIcon(hue, zoom),\n        zIndex: spawnPointIndex(hue)\n    })\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: spawnpointLabel(item),\n        disableAutoPan: true,\n        position: circleCenter\n    })\n\n    addListeners(marker)\n\n    return marker\n}\n\nfunction clearSelection() {\n    if (document.selection) {\n        document.selection.empty()\n    } else if (window.getSelection) {\n        window.getSelection().removeAllRanges()\n    }\n}\n\nfunction addListeners(marker) {\n    marker.addListener('click', function () {\n        if (!marker.infoWindowIsOpen) {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n            marker.persist = true\n            marker.infoWindowIsOpen = true\n        } else {\n            marker.persist = null\n            marker.infoWindow.close()\n            marker.infoWindowIsOpen = false\n        }\n    })\n\n    google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n        marker.persist = null\n    })\n\n    if (!isMobileDevice() && !isTouchDevice()) {\n        marker.addListener('mouseover', function () {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n        })\n    }\n\n    marker.addListener('mouseout', function () {\n        if (!marker.persist) {\n            marker.infoWindow.close()\n        }\n    })\n\n    return marker\n}\n\nfunction clearStaleMarkers() {\n    $.each(mapData.pokemons, function (key, value) {\n        if (mapData.pokemons[key]['disappear_time'] < new Date().getTime() ||\n            excludedPokemon.indexOf(mapData.pokemons[key]['pokemon_id']) >= 0) {\n            if (mapData.pokemons[key].marker.rangeCircle) {\n                mapData.pokemons[key].marker.rangeCircle.setMap(null)\n                delete mapData.pokemons[key].marker.rangeCircle\n            }\n            mapData.pokemons[key].marker.setMap(null)\n            delete mapData.pokemons[key]\n        }\n    })\n\n    $.each(mapData.lurePokemons, function (key, value) {\n        if (mapData.lurePokemons[key]['lure_expiration'] < new Date().getTime() ||\n            excludedPokemon.indexOf(mapData.lurePokemons[key]['pokemon_id']) >= 0) {\n            mapData.lurePokemons[key].marker.setMap(null)\n            delete mapData.lurePokemons[key]\n        }\n    })\n\n    $.each(mapData.scanned, function (key, value) {\n        // If older than 15mins remove\n        if (mapData.scanned[key]['last_modified'] < (new Date().getTime() - 15 * 60 * 1000)) {\n            mapData.scanned[key].marker.setMap(null)\n            delete mapData.scanned[key]\n        }\n    })\n}\n\nfunction showInBoundsMarkers(markers, type) {\n    $.each(markers, function (key, value) {\n        var marker = markers[key].marker\n        var show = false\n        if (!markers[key].hidden) {\n            if (typeof marker.getBounds === 'function') {\n                if (map.getBounds().intersects(marker.getBounds())) {\n                    show = true\n                }\n            } else if (typeof marker.getPosition === 'function') {\n                if (map.getBounds().contains(marker.getPosition())) {\n                    show = true\n                }\n            }\n        }\n        // marker has an associated range\n        if (show && rangeMarkers.indexOf(type) !== -1) {\n            // no range circle yet...let's create one\n            if (!marker.rangeCircle) {\n                // but only if range is active\n                if (isRangeActive(map)) {\n                    if (type === 'gym') marker.rangeCircle = addRangeCircle(marker, map, type, markers[key].team_id)\n                    else marker.rangeCircle = addRangeCircle(marker, map, type)\n                }\n            } else { // there's already a range circle\n                if (isRangeActive(map)) {\n                    marker.rangeCircle.setMap(map)\n                } else {\n                    marker.rangeCircle.setMap(null)\n                }\n            }\n        }\n\n        if (show && !marker.getMap()) {\n            marker.setMap(map)\n            // Not all markers can be animated (ex: scan locations)\n            if (marker.setAnimation && marker.oldAnimation) {\n                marker.setAnimation(marker.oldAnimation)\n            }\n        } else if (!show && marker.getMap()) {\n            // Not all markers can be animated (ex: scan locations)\n            if (marker.getAnimation) {\n                marker.oldAnimation = marker.getAnimation()\n            }\n            if (marker.rangeCircle) marker.rangeCircle.setMap(null)\n            marker.setMap(null)\n        }\n    })\n}\n\nfunction loadRawData() {\n    var loadPokemon = Store.get('showPokemon')\n    var loadGyms = Store.get('showGyms')\n    var loadPokestops = Store.get('showPokestops')\n    var loadScanned = Store.get('showScanned')\n    var loadSpawnpoints = Store.get('showSpawnpoints')\n    var loadLuredOnly = Boolean(Store.get('showLuredPokestopsOnly'))\n\n    var bounds = map.getBounds()\n    var swPoint = bounds.getSouthWest()\n    var nePoint = bounds.getNorthEast()\n    var swLat = swPoint.lat()\n    var swLng = swPoint.lng()\n    var neLat = nePoint.lat()\n    var neLng = nePoint.lng()\n\n    return $.ajax({\n        url: 'raw_data.php',\n        type: 'GET',\n        data: {\n            'timestamp': timestamp,\n            'pokemon': loadPokemon,\n            'lastpokemon': lastpokemon,\n            'pokestops': loadPokestops,\n            'lastpokestops': lastpokestops,\n            'luredonly': loadLuredOnly,\n            'gyms': loadGyms,\n            'lastgyms': lastgyms,\n            'scanned': loadScanned,\n            'lastslocs': lastslocs,\n            'spawnpoints': loadSpawnpoints,\n            'lastspawns': lastspawns,\n            'swLat': swLat,\n            'swLng': swLng,\n            'neLat': neLat,\n            'neLng': neLng,\n            'oSwLat': oSwLat,\n            'oSwLng': oSwLng,\n            'oNeLat': oNeLat,\n            'oNeLng': oNeLng,\n            'reids': String(reincludedPokemon),\n            'eids': String(excludedPokemon)\n        },\n        dataType: 'json',\n        cache: false,\n        beforeSend: function () {\n            if (rawDataIsLoading) {\n                return false\n            } else {\n                rawDataIsLoading = true\n            }\n        },\n        error: function () {\n            if (!$timeoutDialog) {\n                var opts = {\n                    title: 'Reduce marker settings'\n                }\n\n                $timeoutDialog = $('<div>Hmm... we\\'re having problems getting data for your criteria. Try reducing what you\\'re showing and zooming in to limit what\\'s returned.</div>').dialog(opts)\n                $timeoutDialog.dialog('open')\n            } else if (!$timeoutDialog.dialog('isOpen')) {\n                $timeoutDialog.dialog('open')\n            }\n        },\n        complete: function () {\n            rawDataIsLoading = false\n        }\n    })\n}\n\nfunction processPokemons(i, item) {\n    if (!Store.get('showPokemon')) {\n        return false // in case the checkbox was unchecked in the meantime.\n    }\n\n    if (!(item['encounter_id'] in mapData.pokemons) &&\n        excludedPokemon.indexOf(item['pokemon_id']) < 0 && item['disappear_time'] > Date.now()) {\n        // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        if (!item.hidden) {\n            item.marker = setupPokemonMarker(item, map)\n            customizePokemonMarker(item.marker, item)\n            mapData.pokemons[item['encounter_id']] = item\n        }\n    }\n}\n\nfunction processPokestops(i, item) {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    if (Store.get('showLuredPokestopsOnly') && !item['lure_expiration']) {\n        return true\n    }\n\n    if (!mapData.pokestops[item['pokestop_id']]) { // new pokestop, add marker to map and item to dict\n        if (item.marker && item.marker.rangeCircle) {\n            item.marker.rangeCircle.setMap(null)\n        }\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupPokestopMarker(item)\n        mapData.pokestops[item['pokestop_id']] = item\n    } else { // change existing pokestop marker to unlured/lured\n        var item2 = mapData.pokestops[item['pokestop_id']]\n        if (!!item['lure_expiration'] !== !!item2['lure_expiration']) {\n            if (item2.marker && item2.marker.rangeCircle) {\n                item2.marker.rangeCircle.setMap(null)\n            }\n            item2.marker.setMap(null)\n            item.marker = setupPokestopMarker(item)\n            mapData.pokestops[item['pokestop_id']] = item\n        }\n    }\n}\n\nfunction updatePokestops() {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    var removeStops = []\n    var currentTime = new Date().getTime()\n\n    // change lured pokestop marker to unlured when expired\n    $.each(mapData.pokestops, function (key, value) {\n        if (value['lure_expiration'] && value['lure_expiration'] < currentTime) {\n            value['lure_expiration'] = null\n            if (value.marker && value.marker.rangeCircle) {\n                value.marker.rangeCircle.setMap(null)\n            }\n            value.marker.setMap(null)\n            value.marker = setupPokestopMarker(value)\n        }\n    })\n\n    // remove unlured stops if show lured only is selected\n    if (Store.get('showLuredPokestopsOnly')) {\n        $.each(mapData.pokestops, function (key, value) {\n            if (!value['lure_expiration']) {\n                removeStops.push(key)\n            }\n        })\n        $.each(removeStops, function (key, value) {\n            if (mapData.pokestops[value] && mapData.pokestops[value].marker) {\n                if (mapData.pokestops[value].marker.rangeCircle) {\n                    mapData.pokestops[value].marker.rangeCircle.setMap(null)\n                }\n                mapData.pokestops[value].marker.setMap(null)\n                delete mapData.pokestops[value]\n            }\n        })\n    }\n}\n\nfunction processGyms(i, item) {\n    if (!Store.get('showGyms')) {\n        return false // in case the checkbox was unchecked in the meantime.\n    }\n\n    var gymLevel = getGymLevel(item.gym_points)\n    var removeGymFromMap = function (gymid) {\n        if (mapData.gyms[gymid] && mapData.gyms[gymid].marker) {\n            if (mapData.gyms[gymid].marker.rangeCircle) {\n                mapData.gyms[gymid].marker.rangeCircle.setMap(null)\n            }\n            mapData.gyms[gymid].marker.setMap(null)\n            delete mapData.gyms[gymid]\n        }\n    }\n\n    var gymHasOpenSpot = function (gymLevel, pokemonInGym) {\n        return gymLevel > item.pokemon.length && item.pokemon.length !== 0\n    }\n\n    if (Store.get('showOpenGymsOnly') === 1) {\n        if (!gymHasOpenSpot(gymLevel, item.pokemon.length)) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (Store.get('showOpenGymsOnly') > 1) {\n        var closePrestige = 0\n        switch (Store.get('showOpenGymsOnly')) {\n            case 2:\n                closePrestige = 1000\n                break\n            case 3:\n                closePrestige = 2500\n                break\n            case 4:\n                closePrestige = 5000\n                break\n        }\n\n        if (!gymHasOpenSpot(gymLevel, item.pokemon.length) && (gymPrestige[gymLevel - 1] > closePrestige + item.gym_points || gymLevel === 10)) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (Store.get('showTeamGymsOnly') && Store.get('showTeamGymsOnly') !== item.team_id) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (Store.get('showLastUpdatedGymsOnly')) {\n        var now = new Date()\n        if ((Store.get('showLastUpdatedGymsOnly') * 3600 * 1000) + item.last_scanned < now.getTime()) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (gymLevel < Store.get('minGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (gymLevel > Store.get('maxGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (item['gym_id'] in mapData.gyms) {\n        item.marker = updateGymMarker(item, mapData.gyms[item['gym_id']].marker)\n    } else { // add marker to map and item to dict\n        item.marker = setupGymMarker(item)\n    }\n    mapData.gyms[item['gym_id']] = item\n}\n\nfunction processScanned(i, item) {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    var scanId = item['latitude'] + '|' + item['longitude']\n\n    if (!(scanId in mapData.scanned)) { // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupScannedMarker(item)\n        mapData.scanned[scanId] = item\n    } else {\n        mapData.scanned[scanId].last_modified = item['last_modified']\n    }\n}\n\nfunction updateScanned() {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    $.each(mapData.scanned, function (key, value) {\n        if (map.getBounds().intersects(value.marker.getBounds())) {\n            value.marker.setOptions({\n                fillColor: getColorByDate(value['last_modified'])\n            })\n        }\n    })\n}\n\nfunction processSpawnpoints(i, item) {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var id = item['spawnpoint_id']\n\n    if (!(id in mapData.spawnpoints)) { // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupSpawnpointMarker(item)\n        mapData.spawnpoints[id] = item\n    }\n}\n\nfunction updateSpawnPoints() {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var zoom = map.getZoom()\n\n    $.each(mapData.spawnpoints, function (key, value) {\n        if (map.getBounds().contains(value.marker.getPosition())) {\n            var hue = getColorBySpawnTime(value['time'])\n            value.marker.setIcon(changeSpawnIcon(hue, zoom))\n            value.marker.setZIndex(spawnPointIndex(hue))\n        }\n    })\n}\n\nfunction updateMap() {\n    loadRawData().done(function (result) {\n        $.each(result.pokemons, processPokemons)\n        $.each(result.pokestops, processPokestops)\n        $.each(result.gyms, processGyms)\n        $.each(result.scanned, processScanned)\n        $.each(result.spawnpoints, processSpawnpoints)\n        showInBoundsMarkers(mapData.pokemons, 'pokemon')\n        showInBoundsMarkers(mapData.lurePokemons, 'pokemon')\n        showInBoundsMarkers(mapData.gyms, 'gym')\n        showInBoundsMarkers(mapData.pokestops, 'pokestop')\n        showInBoundsMarkers(mapData.scanned, 'scanned')\n        showInBoundsMarkers(mapData.spawnpoints, 'inbound')\n        //      drawScanPath(result.scanned);\n        clearStaleMarkers()\n\n        updateScanned()\n        updateSpawnPoints()\n        updatePokestops()\n\n        if ($('#stats').hasClass('visible')) {\n            countMarkers(map)\n        }\n\n        oSwLat = result.oSwLat\n        oSwLng = result.oSwLng\n        oNeLat = result.oNeLat\n        oNeLng = result.oNeLng\n\n        lastgyms = result.lastgyms\n        lastpokestops = result.lastpokestops\n        lastpokemon = result.lastpokemon\n        lastslocs = result.lastslocs\n        lastspawns = result.lastspawns\n\n        reids = result.reids\n        if (reids instanceof Array) {\n            reincludedPokemon = reids.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, reincludedPokemon)\n        }\n        timestamp = result.timestamp\n        lastUpdateTime = Date.now()\n    })\n}\n\nfunction drawScanPath(points) { // eslint-disable-line no-unused-vars\n    var scanPathPoints = []\n    $.each(points, function (idx, point) {\n        scanPathPoints.push({\n            lat: point['latitude'],\n            lng: point['longitude']\n        })\n    })\n    if (scanPath) {\n        scanPath.setMap(null)\n    }\n    scanPath = new google.maps.Polyline({\n        path: scanPathPoints,\n        geodesic: true,\n        strokeColor: '#FF0000',\n        strokeOpacity: 1.0,\n        strokeWeight: 2,\n        map: map\n    })\n}\n\nfunction redrawPokemon(pokemonList) {\n    var skipNotification = true\n    $.each(pokemonList, function (key, value) {\n        var item = pokemonList[key]\n        if (!item.hidden) {\n            if (item.marker.rangeCircle) item.marker.rangeCircle.setMap(null)\n            var newMarker = setupPokemonMarker(item, map, this.marker.animationDisabled)\n            customizePokemonMarker(newMarker, item, skipNotification)\n            item.marker.setMap(null)\n            pokemonList[key].marker = newMarker\n        }\n    })\n}\n\nvar updateLabelDiffTime = function () {\n    $('.label-countdown').each(function (index, element) {\n        var disappearsAt = getTimeUntil(parseInt(element.getAttribute('disappears-at')))\n\n        var hours = disappearsAt.hour\n        var minutes = disappearsAt.min\n        var seconds = disappearsAt.sec\n        var timestring = ''\n\n        if (disappearsAt.ttime < disappearsAt.now) {\n            timestring = '(expired)'\n        } else {\n            timestring = '('\n            if (hours > 0) {\n                timestring = hours + 'h'\n            }\n\n            timestring += lpad(minutes, 2, 0) + 'm'\n            timestring += lpad(seconds, 2, 0) + 's'\n            timestring += ')'\n        }\n\n        $(element).text(timestring)\n    })\n}\n\nfunction getPointDistance(pointA, pointB) {\n    return google.maps.geometry.spherical.computeDistanceBetween(pointA, pointB)\n}\n\nfunction sendNotification(title, text, icon, lat, lng) {\n    if (!('Notification' in window)) {\n        return false // Notifications are not present in browser\n    }\n\n    if (Notification.permission !== 'granted') {\n        Notification.requestPermission()\n    } else {\n        var notification = new Notification(title, {\n            icon: icon,\n            body: text,\n            sound: 'sounds/ding.mp3'\n        })\n\n        notification.onclick = function () {\n            window.focus()\n            notification.close()\n\n            centerMap(lat, lng, 20)\n        }\n    }\n}\n\nfunction createMyLocationButton() {\n    var locationContainer = document.createElement('div')\n\n    var locationButton = document.createElement('button')\n    locationButton.style.backgroundColor = '#fff'\n    locationButton.style.border = 'none'\n    locationButton.style.outline = 'none'\n    locationButton.style.width = '28px'\n    locationButton.style.height = '28px'\n    locationButton.style.borderRadius = '2px'\n    locationButton.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)'\n    locationButton.style.cursor = 'pointer'\n    locationButton.style.marginRight = '10px'\n    locationButton.style.padding = '0px'\n    locationButton.title = 'My Location'\n    locationContainer.appendChild(locationButton)\n\n    var locationIcon = document.createElement('div')\n    locationIcon.style.margin = '5px'\n    locationIcon.style.width = '18px'\n    locationIcon.style.height = '18px'\n    locationIcon.style.backgroundImage = 'url(static/mylocation-sprite-1x.png)'\n    locationIcon.style.backgroundSize = '180px 18px'\n    locationIcon.style.backgroundPosition = '0px 0px'\n    locationIcon.style.backgroundRepeat = 'no-repeat'\n    locationIcon.id = 'current-location'\n    locationButton.appendChild(locationIcon)\n\n    locationButton.addEventListener('click', function () {\n        centerMapOnLocation()\n    })\n\n    locationContainer.index = 1\n    map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(locationContainer)\n\n    google.maps.event.addListener(map, 'dragend', function () {\n        var currentLocation = document.getElementById('current-location')\n        currentLocation.style.backgroundPosition = '0px 0px'\n    })\n}\n\nfunction centerMapOnLocation() {\n    var currentLocation = document.getElementById('current-location')\n    var imgX = '0'\n    var animationInterval = setInterval(function () {\n        if (imgX === '-18') {\n            imgX = '0'\n        } else {\n            imgX = '-18'\n        }\n        currentLocation.style.backgroundPosition = imgX + 'px 0'\n    }, 500)\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\n            locationMarker.setPosition(latlng)\n            map.setCenter(latlng)\n            Store.set('followMyLocationPosition', {\n                lat: position.coords.latitude,\n                lng: position.coords.longitude\n            })\n            clearInterval(animationInterval)\n            currentLocation.style.backgroundPosition = '-144px 0px'\n        })\n    } else {\n        clearInterval(animationInterval)\n        currentLocation.style.backgroundPosition = '0px 0px'\n    }\n}\n\nfunction changeLocation(lat, lng) {\n    var loc = new google.maps.LatLng(lat, lng)\n    changeSearchLocation(lat, lng).done(function () {\n        map.setCenter(loc)\n        searchMarker.setPosition(loc)\n    })\n}\n\nfunction changeSearchLocation(lat, lng) {\n    return $.post('next_loc?lat=' + lat + '&lon=' + lng, {})\n}\n\nfunction centerMap(lat, lng, zoom) {\n    var loc = new google.maps.LatLng(lat, lng)\n\n    map.setCenter(loc)\n\n    if (zoom) {\n        storeZoom = false\n        map.setZoom(zoom)\n    }\n}\n\nfunction i8ln(word) {\n    if ($.isEmptyObject(i8lnDictionary) && language !== 'en' && languageLookups < languageLookupThreshold) {\n        $.ajax({\n            url: 'static/dist/locales/' + language + '.min.json',\n            dataType: 'json',\n            async: false,\n            success: function (data) {\n                i8lnDictionary = data\n            },\n            error: function (jqXHR, status, error) {\n                console.log('Error loading i8ln dictionary: ' + error)\n                languageLookups++\n            }\n        })\n    }\n    if (word in i8lnDictionary) {\n        return i8lnDictionary[word]\n    } else {\n        // Word doesn't exist in dictionary return it as is\n        return word\n    }\n}\n\nfunction updateGeoLocation() {\n    if (navigator.geolocation && (Store.get('geoLocate') || Store.get('followMyLocation'))) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var lat = position.coords.latitude\n            var lng = position.coords.longitude\n            var center = new google.maps.LatLng(lat, lng)\n\n            if (Store.get('geoLocate')) {\n                // the search function makes any small movements cause a loop. Need to increase resolution\n                if ((typeof searchMarker !== 'undefined') && (getPointDistance(searchMarker.getPosition(), center) > 40)) {\n                    $.post('next_loc?lat=' + lat + '&lon=' + lng).done(function () {\n                        map.panTo(center)\n                        searchMarker.setPosition(center)\n                    })\n                }\n            }\n            if (Store.get('followMyLocation')) {\n                if ((typeof locationMarker !== 'undefined') && (getPointDistance(locationMarker.getPosition(), center) >= 5)) {\n                    map.panTo(center)\n                    locationMarker.setPosition(center)\n                    Store.set('followMyLocationPosition', {\n                        lat: lat,\n                        lng: lng\n                    })\n                }\n            }\n        })\n    }\n}\n\nfunction createUpdateWorker() {\n    try {\n        if (isMobileDevice() && (window.Worker)) {\n            var updateBlob = new Blob([`onmessage = function(e) {\n                var data = e.data\n                if (data.name === 'backgroundUpdate') {\n                    self.setInterval(function () {self.postMessage({name: 'backgroundUpdate'})}, 5000)\n                }\n            }`])\n\n            var updateBlobURL = window.URL.createObjectURL(updateBlob)\n\n            updateWorker = new Worker(updateBlobURL)\n\n            updateWorker.onmessage = function (e) {\n                var data = e.data\n                if (document.hidden && data.name === 'backgroundUpdate' && Date.now() - lastUpdateTime > 2500) {\n                    updateMap()\n                    updateGeoLocation()\n                }\n            }\n\n            updateWorker.postMessage({\n                name: 'backgroundUpdate'\n            })\n        }\n    } catch (ex) {\n        console.log('Webworker error: ' + ex.message)\n    }\n}\n\nfunction showGymDetails(id) { // eslint-disable-line no-unused-vars\n    var sidebar = document.querySelector('#gym-details')\n    var sidebarClose\n\n    sidebar.classList.add('visible')\n\n    var data = $.ajax({\n        url: 'gym_data',\n        type: 'GET',\n        data: {\n            'id': id\n        },\n        dataType: 'json',\n        cache: false\n    })\n\n    data.done(function (result) {\n        var gymLevel = getGymLevel(result.gym_points)\n        var nextLvlPrestige = gymPrestige[gymLevel - 1] || 50000\n        var prestigePercentage = (result.gym_points / nextLvlPrestige) * 100\n        var lastScannedDate = new Date(result.last_scanned)\n        var freeSlots = result.pokemon.length ? gymLevel - result.pokemon.length : 0\n        var freeSlotsStr = freeSlots ? ` - ${freeSlots} Free Slots` : ''\n        var gymLevelStr = ''\n\n        if (result.team_id === 0) {\n            gymLevelStr = `\n                <center class=\"team-${result.team_id}-text\">\n                    <b class=\"team-${result.team_id}-text\">Uncontested - 1 Free Slot</b>\n                </center>`\n        } else {\n            gymLevelStr = `<div>\n                <b class=\"team-${result.team_id}-text\">Level ${gymLevel}${freeSlotsStr}</b>\n            </div>`\n        }\n        var pokemonHtml = ''\n        var headerHtml = `\n            <center class=\"team-${result.team_id}-text\">\n                <div>\n                    <b class=\"team-${result.team_id}-text\">${result.name || ''}</b>\n                </div>\n                <img height=\"100px\" style=\"padding: 5px;\" src=\"static/forts/${gymTypes[result.team_id]}_large.png\">\n                <div class=\"prestige-bar team-${result.team_id}\">\n                    <div class=\"prestige team-${result.team_id}\" style=\"width: ${prestigePercentage}%\">\n                    </div>\n                </div>\n                <div>\n                    ${result.gym_points}/${nextLvlPrestige}\n                </div>\n                ${gymLevelStr}\n                <div style=\"font-size: .7em;\">\n                    Last Scanned: ${lastScannedDate.getFullYear()}-${pad(lastScannedDate.getMonth() + 1)}-${pad(lastScannedDate.getDate())} ${pad(lastScannedDate.getHours())}:${pad(lastScannedDate.getMinutes())}:${pad(lastScannedDate.getSeconds())}\n                </div>\n                <div>\n                    <a href='javascript:void(0);' onclick='javascript:openMapDirections(${result.latitude},${result.longitude});' title='View in Maps'>Get directions</a>\n                </div>\n            </center>\n        `\n\n        if (result.pokemon.length) {\n            $.each(result.pokemon, function (i, pokemon) {\n                var perfectPercent = getIv(pokemon.iv_attack, pokemon.iv_defense, pokemon.iv_stamina)\n                var moveEnergy = Math.round(100 / pokemon.move_2_energy)\n\n                pokemonHtml += `\n                    <tr onclick=toggleGymPokemonDetails(this)>\n                        <td width=\"30px\">\n                            <i class=\"pokemon-sprite n${pokemon.pokemon_id}\"></i>\n                        </td>\n                        <td class=\"team-${result.team_id}-text\">\n                            <div style=\"line-height:1em;\">${pokemon.pokemon_name}</div>\n                            <div class=\"cp\">CP ${pokemon.pokemon_cp}</div>\n                        </td>\n                        <td width=\"190\" class=\"team-${result.team_id}-text\" align=\"center\">\n                            <div class=\"trainer-level\">${pokemon.trainer_level}</div>\n                            <div style=\"line-height: 1em;\">${pokemon.trainer_name}</div>\n                        </td>\n                        <td width=\"10\">\n                            <!--<a href=\"#\" onclick=\"toggleGymPokemonDetails(this)\">-->\n                                <i class=\"team-${result.team_id}-text fa fa-angle-double-down\"></i>\n                            <!--</a>-->\n                        </td>\n                    </tr>\n                    <tr class=\"details\">\n                        <td colspan=\"2\">\n                            <div class=\"ivs\">\n                                <div class=\"iv\">\n                                    <div class=\"type\">ATK</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_attack}\n                                    </div>\n                                </div>\n                                <div class=\"iv\">\n                                    <div class=\"type\">DEF</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_defense}\n                                    </div>\n                                </div>\n                                <div class=\"iv\">\n                                    <div class=\"type\">STA</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_stamina}\n                                    </div>\n                                </div>\n                                <div class=\"iv\" style=\"width: 36px;\"\">\n                                    <div class=\"type\">PERFECT</div>\n                                    <div class=\"value\">\n                                        ${perfectPercent.toFixed(0)}<span style=\"font-size: .6em;\">%</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                        <td colspan=\"2\">\n                            <div class=\"moves\">\n                                <div class=\"move\">\n                                    <div class=\"name\">\n                                        ${pokemon.move_1_name}\n                                        <div class=\"type ${pokemon.move_1_type['type_en'].toLowerCase()}\">${pokemon.move_1_type['type']}</div>\n                                    </div>\n                                    <div class=\"damage\">\n                                        ${pokemon.move_1_damage}\n                                    </div>\n                                </div>\n                                <br>\n                                <div class=\"move\">\n                                    <div class=\"name\">\n                                        ${pokemon.move_2_name}\n                                        <div class=\"type ${pokemon.move_2_type['type_en'].toLowerCase()}\">${pokemon.move_2_type['type']}</div>\n                                        <div>\n                                            <i class=\"move-bar-sprite move-bar-sprite-${moveEnergy}\"></i>\n                                        </div>\n                                    </div>\n                                    <div class=\"damage\">\n                                        ${pokemon.move_2_damage}\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                    </tr>\n                    `\n            })\n\n            pokemonHtml = `<table><tbody>${pokemonHtml}</tbody></table>`\n        } else if (result.team_id === 0) {\n            pokemonHtml = ''\n        } else {\n            pokemonHtml = `\n                <center class=\"team-${result.team_id}-text\">\n                    Gym Leader:<br>\n                    <i class=\"pokemon-large-sprite n${result.guard_pokemon_id}\"></i><br>\n                    <b class=\"team-${result.team_id}-text\">${result.guard_pokemon_name}</b>\n\n                    <p style=\"font-size: .75em; margin: 5px;\">\n                        No additional gym information is available for this gym. Make sure you are collecting <a href=\"https://pgm.readthedocs.io/en/develop/extras/gyminfo.html\">detailed gym info.</a>\n                        If you have detailed gym info collection running, this gym's Pokemon information may be out of date.\n                    </p>\n                </center>\n            `\n        }\n\n        sidebar.innerHTML = `${headerHtml}${pokemonHtml}`\n\n        sidebarClose = document.createElement('a')\n        sidebarClose.href = '#'\n        sidebarClose.className = 'close'\n        sidebarClose.tabIndex = 0\n        sidebar.appendChild(sidebarClose)\n\n        sidebarClose.addEventListener('click', function (event) {\n            event.preventDefault()\n            event.stopPropagation()\n            sidebar.classList.remove('visible')\n        })\n    })\n}\n\nfunction toggleGymPokemonDetails(e) { // eslint-disable-line no-unused-vars\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-up')\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-down')\n    e.nextElementSibling.classList.toggle('visible')\n}\n\n//\n// Page Ready Exection\n//\n\n$(function () {\n    if (!Notification) {\n        console.log('could not load notifications')\n        return\n    }\n\n    if (Notification.permission !== 'granted') {\n        Notification.requestPermission()\n    }\n})\n\n$(function () {\n    // populate Navbar Style menu\n    $selectStyle = $('#map-style')\n\n    // Load Stylenames, translate entries, and populate lists\n    $.getJSON('static/dist/data/mapstyle.min.json').done(function (data) {\n        var styleList = []\n\n        $.each(data, function (key, value) {\n            styleList.push({\n                id: key,\n                text: i8ln(value)\n            })\n        })\n\n        // setup the stylelist\n        $selectStyle.select2({\n            placeholder: 'Select Style',\n            data: styleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        // setup the list change behavior\n        $selectStyle.on('change', function (e) {\n            selectedStyle = $selectStyle.val()\n            map.setMapTypeId(selectedStyle)\n            Store.set('map_style', selectedStyle)\n        })\n\n        // recall saved mapstyle\n        $selectStyle.val(Store.get('map_style')).trigger('change')\n    })\n\n    $selectIconSize = $('#pokemon-icon-size')\n\n    $selectIconSize.select2({\n        placeholder: 'Select Icon Size',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectIconSize.on('change', function () {\n        Store.set('iconSizeModifier', this.value)\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n    })\n\n    $selectOpenGymsOnly = $('#open-gyms-only-switch')\n\n    $selectOpenGymsOnly.select2({\n        placeholder: 'Only Show Open Gyms',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectOpenGymsOnly.on('change', function () {\n        Store.set('showOpenGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectTeamGymsOnly = $('#team-gyms-only-switch')\n\n    $selectTeamGymsOnly.select2({\n        placeholder: 'Only Show Gyms For Team',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectTeamGymsOnly.on('change', function () {\n        Store.set('showTeamGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLastUpdateGymsOnly = $('#last-update-gyms-switch')\n\n    $selectLastUpdateGymsOnly.select2({\n        placeholder: 'Only Show Gyms Last Updated',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLastUpdateGymsOnly.on('change', function () {\n        Store.set('showLastUpdatedGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMinGymLevel = $('#min-level-gyms-filter-switch')\n\n    $selectMinGymLevel.select2({\n        placeholder: 'Minimum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMinGymLevel.on('change', function () {\n        Store.set('minGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMaxGymLevel = $('#max-level-gyms-filter-switch')\n\n    $selectMaxGymLevel.select2({\n        placeholder: 'Maximum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMaxGymLevel.on('change', function () {\n        Store.set('maxGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLuredPokestopsOnly = $('#lured-pokestops-only-switch')\n\n    $selectLuredPokestopsOnly.select2({\n        placeholder: 'Only Show Lured Pokestops',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLuredPokestopsOnly.on('change', function () {\n        Store.set('showLuredPokestopsOnly', this.value)\n        lastpokestops = false\n        updateMap()\n    })\n    $switchGymSidebar = $('#gym-sidebar-switch')\n\n    $switchGymSidebar.on('change', function () {\n        Store.set('useGymSidebar', this.checked)\n        lastgyms = false\n        $.each(['gyms'], function (d, dType) {\n            $.each(mapData[dType], function (key, value) {\n                // for any marker you're turning off, you'll want to wipe off the range\n                if (mapData[dType][key].marker.rangeCircle) {\n                    mapData[dType][key].marker.rangeCircle.setMap(null)\n                    delete mapData[dType][key].marker.rangeCircle\n                }\n                mapData[dType][key].marker.setMap(null)\n            })\n            mapData[dType] = {}\n        })\n        updateMap()\n    })\n\n    $selectSearchIconMarker = $('#iconmarker-style')\n    $selectLocationIconMarker = $('#locationmarker-style')\n\n    $.getJSON('static/dist/data/searchmarkerstyle.min.json').done(function (data) {\n        searchMarkerStyles = data\n        var searchMarkerStyleList = []\n\n        $.each(data, function (key, value) {\n            searchMarkerStyleList.push({\n                id: key,\n                text: value.name\n            })\n        })\n\n        $selectSearchIconMarker.select2({\n            placeholder: 'Select Icon Marker',\n            data: searchMarkerStyleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        $selectSearchIconMarker.on('change', function (e) {\n            var selectSearchIconMarker = $selectSearchIconMarker.val()\n            Store.set('searchMarkerStyle', selectSearchIconMarker)\n            updateSearchMarker(selectSearchIconMarker)\n        })\n\n        $selectSearchIconMarker.val(Store.get('searchMarkerStyle')).trigger('change')\n\n        updateSearchMarker(Store.get('lockMarker'))\n\n        $selectLocationIconMarker.select2({\n            placeholder: 'Select Location Marker',\n            data: searchMarkerStyleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        $selectLocationIconMarker.on('change', function (e) {\n            Store.set('locationMarkerStyle', this.value)\n            updateLocationMarker(this.value)\n        })\n\n        $selectLocationIconMarker.val(Store.get('locationMarkerStyle')).trigger('change')\n    })\n\n    $selectGymMarkerStyle = $('#gym-marker-style')\n\n    $selectGymMarkerStyle.select2({\n        placeholder: 'Select Style',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectGymMarkerStyle.on('change', function (e) {\n        Store.set('gymMarkerStyle', this.value)\n        updateGymIcons()\n    })\n\n    $selectGymMarkerStyle.val(Store.get('gymMarkerStyle')).trigger('change')\n})\n\n$(function () {\n    function formatState(state) {\n        if (!state.id) {\n            return state.text\n        }\n        var $state = $(\n            '<span><i class=\"pokemon-sprite n' + state.element.value.toString() + '\"></i> ' + state.text + '</span>'\n        )\n        return $state\n    }\n\n    if (Store.get('startAtUserLocation')) {\n        centerMapOnLocation()\n    }\n\n    $.getJSON('static/dist/data/moves.min.json').done(function (data) {\n        moves = data\n    })\n\n    $selectExclude = $('#exclude-pokemon')\n    $selectPokemonNotify = $('#notify-pokemon')\n    $selectRarityNotify = $('#notify-rarity')\n    $textPerfectionNotify = $('#notify-perfection')\n    var numberOfPokemon = 493\n\n    // Load pokemon names and populate lists\n    $.getJSON('static/dist/data/pokemon.min.json').done(function (data) {\n        var pokeList = []\n\n        $.each(data, function (key, value) {\n            if (key > numberOfPokemon) {\n                return false\n            }\n            var _types = []\n            pokeList.push({\n                id: key,\n                text: i8ln(value['name']) + ' - #' + key\n            })\n            value['name'] = i8ln(value['name'])\n            value['rarity'] = i8ln(value['rarity'])\n            $.each(value['types'], function (key, pokemonType) {\n                _types.push({\n                    'type': i8ln(pokemonType['type']),\n                    'color': pokemonType['color']\n                })\n            })\n            value['types'] = _types\n            idToPokemon[key] = value\n        })\n\n        // setup the filter lists\n        $selectExclude.select2({\n            placeholder: i8ln('Select Pokémon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectPokemonNotify.select2({\n            placeholder: i8ln('Select Pokémon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectRarityNotify.select2({\n            placeholder: i8ln('Select Rarity'),\n            data: [i8ln('Common'), i8ln('Uncommon'), i8ln('Rare'), i8ln('Very Rare'), i8ln('Ultra Rare')],\n            templateResult: formatState\n        })\n\n        // setup list change behavior now that we have the list to work from\n        $selectExclude.on('change', function (e) {\n            buffer = excludedPokemon\n            excludedPokemon = $selectExclude.val().map(Number)\n            buffer = buffer.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, excludedPokemon)\n            reincludedPokemon = reincludedPokemon.concat(buffer)\n            clearStaleMarkers()\n            Store.set('remember_select_exclude', excludedPokemon)\n        })\n        $selectPokemonNotify.on('change', function (e) {\n            notifiedPokemon = $selectPokemonNotify.val().map(Number)\n            Store.set('remember_select_notify', notifiedPokemon)\n        })\n        $selectRarityNotify.on('change', function (e) {\n            notifiedRarity = $selectRarityNotify.val().map(String)\n            Store.set('remember_select_rarity_notify', notifiedRarity)\n        })\n        $textPerfectionNotify.on('change', function (e) {\n            notifiedMinPerfection = parseInt($textPerfectionNotify.val(), 10)\n            if (isNaN(notifiedMinPerfection) || notifiedMinPerfection <= 0) {\n                notifiedMinPerfection = ''\n            }\n            if (notifiedMinPerfection > 100) {\n                notifiedMinPerfection = 100\n            }\n            $textPerfectionNotify.val(notifiedMinPerfection)\n            Store.set('remember_text_perfection_notify', notifiedMinPerfection)\n        })\n\n        // recall saved lists\n        $selectExclude.val(Store.get('remember_select_exclude')).trigger('change')\n        $selectPokemonNotify.val(Store.get('remember_select_notify')).trigger('change')\n        $selectRarityNotify.val(Store.get('remember_select_rarity_notify')).trigger('change')\n        $textPerfectionNotify.val(Store.get('remember_text_perfection_notify')).trigger('change')\n\n        if (isTouchDevice() && isMobileDevice()) {\n            $('.select2-search input').prop('readonly', true)\n        }\n    })\n\n    // run interval timers to regularly update map and timediffs\n    window.setInterval(updateLabelDiffTime, 1000)\n    window.setInterval(updateMap, 5000)\n    window.setInterval(updateGeoLocation, 1000)\n\n    createUpdateWorker()\n\n    // Wipe off/restore map icons when switches are toggled\n    function buildSwitchChangeListener(data, dataType, storageKey) {\n        return function () {\n            Store.set(storageKey, this.checked)\n            if (this.checked) {\n                // When switch is turned on we asume it has been off, makes sure we dont end up in limbo\n                // Without this there could've been a situation where no markers are on map and only newly modified ones are loaded\n                if (storageKey === 'showPokemon') {\n                    lastpokemon = false\n                } else if (storageKey === 'showGyms') {\n                    lastgyms = false\n                } else if (storageKey === 'showPokestops') {\n                    lastpokestops = false\n                } else if (storageKey === 'showScanned') {\n                    lastslocs = false\n                } else if (storageKey === 'showSpawnpoints') {\n                    lastspawns = false\n                }\n                updateMap()\n            } else {\n                $.each(dataType, function (d, dType) {\n                    $.each(data[dType], function (key, value) {\n                        // for any marker you're turning off, you'll want to wipe off the range\n                        if (data[dType][key].marker.rangeCircle) {\n                            data[dType][key].marker.rangeCircle.setMap(null)\n                            delete data[dType][key].marker.rangeCircle\n                        }\n                        if (storageKey !== 'showRanges') data[dType][key].marker.setMap(null)\n                    })\n                    if (storageKey !== 'showRanges') data[dType] = {}\n                })\n                if (storageKey === 'showRanges') {\n                    updateMap()\n                }\n            }\n        }\n    }\n\n    // Setup UI element interactions\n    $('#gyms-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#gym-sidebar-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper.show(options)\n        } else {\n            lastgyms = false\n            wrapper.hide(options)\n        }\n        var wrapper2 = $('#gyms-filter-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper2.show(options)\n        } else {\n            lastgyms = false\n            wrapper2.hide(options)\n        }\n        buildSwitchChangeListener(mapData, ['gyms'], 'showGyms').bind(this)()\n    })\n    $('#pokemon-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['pokemons'], 'showPokemon').bind(this)()\n    })\n    $('#scanned-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['scanned'], 'showScanned').bind(this)()\n    })\n    $('#spawnpoints-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['spawnpoints'], 'showSpawnpoints').bind(this)()\n    })\n    $('#ranges-switch').change(buildSwitchChangeListener(mapData, ['gyms', 'pokemons', 'pokestops'], 'showRanges'))\n\n    $('#pokestops-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#lured-pokestops-only-wrapper')\n        if (this.checked) {\n            lastpokestops = false\n            wrapper.show(options)\n        } else {\n            lastpokestops = false\n            wrapper.hide(options)\n        }\n        return buildSwitchChangeListener(mapData, ['pokestops'], 'showPokestops').bind(this)()\n    })\n\n    $('#sound-switch').change(function () {\n        Store.set('playSound', this.checked)\n    })\n\n    $('#geoloc-switch').change(function () {\n        $('#next-location').prop('disabled', this.checked)\n        $('#next-location').css('background-color', this.checked ? '#e0e0e0' : '#ffffff')\n        if (!navigator.geolocation) {\n            this.checked = false\n        } else {\n            Store.set('geoLocate', this.checked)\n        }\n    })\n\n    $('#lock-marker-switch').change(function () {\n        Store.set('lockMarker', this.checked)\n        searchMarker.setDraggable(!this.checked)\n    })\n\n    $('#search-switch').change(function () {\n        searchControl(this.checked ? 'on' : 'off')\n    })\n\n    $('#start-at-user-location-switch').change(function () {\n        Store.set('startAtUserLocation', this.checked)\n    })\n\n    $('#follow-my-location-switch').change(function () {\n        if (!navigator.geolocation) {\n            this.checked = false\n        } else {\n            Store.set('followMyLocation', this.checked)\n        }\n        locationMarker.setDraggable(!this.checked)\n    })\n\n    $('#scan-here-switch').change(function () {\n        if (this.checked && !Store.get('scanHereAlerted')) {\n            alert('Use this feature carefully ! This button will set the current map center as new search location. This may cause worker to teleport long range.')\n            Store.set('scanHereAlerted', true)\n        }\n        $('#scan-here').toggle(this.checked)\n        Store.set('scanHere', this.checked)\n    })\n\n    if ($('#nav-accordion').length) {\n        $('#nav-accordion').accordion({\n            active: 0,\n            collapsible: true,\n            heightStyle: 'content'\n        })\n    }\n\n    // Initialize dataTable in statistics sidebar\n    //   - turn off sorting for the 'icon' column\n    //   - initially sort 'name' column alphabetically\n\n    $('#pokemonList_table').DataTable({\n        paging: false,\n        searching: false,\n        info: false,\n        errMode: 'throw',\n        'language': {\n            'emptyTable': ''\n        },\n        'columns': [\n            { 'orderable': false },\n            null,\n            null,\n            null\n        ]\n    }).order([1, 'asc'])\n})\n"]}